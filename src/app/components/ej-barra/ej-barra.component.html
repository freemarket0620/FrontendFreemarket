<h1>Escáner de Códigos de Barra</h1>

<!-- Botones para controlar la cámara -->
<button (click)="activarCamara()" *ngIf="!camaraActivada">Activar cámara</button>
<button (click)="camaraActivada = false" *ngIf="camaraActivada">Desactivar cámara</button>

<!-- Vista de la cámara -->
<div *ngIf="camaraActivada">
    <div style="overflow: hidden; width: 320px; height: 240px;">
        <zxing-scanner #scanner (scanSuccess)="onCodeResult($event)" [device]="currentDevice" [formats]="formatsEnabled"
            (camerasFound)="onCamerasFound($event)" (permissionResponse)="onHasPermission($event)"
            style="width: 100%; height: 100%; object-fit: cover;" [style.transform]="'scale(' + zoomValue + ')'">
        </zxing-scanner>
    </div>

    <p>El escáner está activo</p>

    <div>
        <label for="zoom">Zoom:</label>
        <input type="range" id="zoom" min="1" max="3" step="0.1" [(ngModel)]="zoomValue" (input)="setZoom(zoomValue)">
        <span>{{ zoomValue }}x</span>
    </div>

    <button (click)="captureAndScan()" *ngIf="hasPermission && hasDevices">Capturar y Escanear</button>
</div>

<!-- Escaneo durante 5 segundos -->
<button (click)="escanearDurante5Segundos()">Escanear por 5 segundos</button>

<!-- Resultados escaneados -->
<div *ngIf="scannedResults.length > 0" style="background-color: aquamarine; margin-top: 1rem;">
    <h3>Códigos escaneados:</h3>
    <ul>
        <li *ngFor="let codigo of scannedResults">{{ codigo }}</li>
    </ul>
</div>

<!-- Sección para escanear desde imagen -->
<h2>Escanear desde imagen</h2>
<input type="file" accept="image/*" (change)="cargarImagen($event)">
<button (click)="escanearImagen()" [disabled]="!imagenSeleccionada">Escanear imagen</button>