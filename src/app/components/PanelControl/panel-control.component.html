<section class="layout">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-md sticky-top bg-light shadow-sm">
    <div
      class="container-fluid mx-2 d-flex justify-content-between align-items-center"
    >
      <!-- Botón para toggle sidebar -->
      <button class="btn btn-outline-secondary me-2" (click)="toggleSidebar()">
        <i class="bi bi-list"></i>
      </button>

      <!-- Título opcional o logo -->
      <span class="navbar-brand mb-0 h1 d-none d-md-block">Mi Panel</span>

      <!-- Botones de usuario y acciones -->
      <div class="d-flex align-items-center gap-2">
        <!-- Perfil -->
        <button
          class="btn p-0 border-0 rounded-circle d-flex align-items-center justify-content-center"
          (click)="verPerfil()"
          style="width: 45px; height: 45px; overflow: hidden"
        >
          <img
            *ngIf="imagen_url"
            [src]="imagen_url"
            class="rounded-circle"
            style="width: 100%; height: 100%; object-fit: cover"
            alt="Perfil"
          />
          <i
            *ngIf="!imagen_url"
            class="fas fa-user-circle fa-2x text-secondary"
          ></i>
        </button>

        <!-- Cerrar sesión -->
        <button
          class="btn btn-outline-danger rounded-circle p-2"
          (click)="confirmarCerrarSesion()"
        >
          <i class="fas fa-power-off"></i>
        </button>

        <!-- Panel de control -->
        <button
          class="btn btn-outline-primary rounded-circle p-2"
          (click)="panelDeControl()"
        >
          <i class="bi bi-house-fill"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Sidebar -->
  <aside
    class="leftSide"
    [class.sidebar-open]="isSidebarOpen"
    [class.sidebar-closed]="!isSidebarOpen"
  >
    <div class="p-3 text-start content p-0 bounce-content">
      <hr class="text-dark" />
      <hr class="text-dark" />

      <p class="text-dark">Nombre: {{ nombre_usuario }} {{ apellido }}</p>
      <p class="text-dark">Rol: {{ roles }}</p>

      <hr class="text-dark" />
      <hr class="text-dark" />

      <ul class="list-group">
        <!-- Gestión de Usuarios -->
        <li
          *ngIf="tieneRol('Administrador')"
          class="d-flex align-items-center"
          (click)="toggleSubmenu('usuarios')"
        >
          <i class="bi bi-people fs-2 text-dark pe-2"></i>
          <span class="text-dark flex-grow-1">Gestión de Usuarios</span>
          <i class="bi bi-chevron-right text-dark"></i>
        </li>

        <ul class="list-group ps-3" *ngIf="isSubmenuOpen('usuarios')">
          <!-- ROLES -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarRoles')"
          >
            <i class="bi bi-person-badge fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-roles"
                class="text-dark text-decoration-none"
              >
                Roles
              </a>
            </div>
          </li>

          <!-- PERMISOS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarPermisos')"
          >
            <i class="bi bi-shield-lock fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-permisos"
                class="text-dark text-decoration-none"
              >
                Permisos
              </a>
            </div>
          </li>

          <!-- USUARIOS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarUsuarios')"
          >
            <i class="bi bi-person-lines-fill fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-usuarios"
                class="text-dark text-decoration-none"
              >
                Usuarios
              </a>
            </div>
          </li>

          <!-- USUARIOS - ROLES -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarUsuarioRoles')"
          >
            <i class="bi bi-diagram-3 fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-usuarios-roles"
                class="text-dark text-decoration-none"
              >
                Usuarios - Roles
              </a>
            </div>
          </li>

          <!-- ROLES - PERMISOS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarRolesPermisos')"
          >
            <i class="bi bi-diagram-2 fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-roles-permisos"
                class="text-dark text-decoration-none"
              >
                Roles - Permisos
              </a>
            </div>
          </li>
        </ul>

        <!-- Productos y Ventas -->
        <li
          class="d-flex align-items-center"
          (click)="toggleSubmenu('productos')"
        >
          <i class="bi bi-basket fs-2 text-dark pe-2"></i>
          <span class="text-dark flex-grow-1">Productos y Ventas</span>
          <i class="bi bi-chevron-right text-dark"></i>
        </li>

        <ul class="list-group ps-3" *ngIf="isSubmenuOpen('productos')">
          <!-- CATEGORÍAS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarCategorias')"
          >
            <i class="bi bi-tags fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-categorias"
                class="text-dark text-decoration-none"
              >
                Categorías
              </a>
            </div>
          </li>

          <!-- PRODUCTOS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('registrarProductos')"
          >
            <i class="bi bi-box-seam fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-productos"
                class="text-dark text-decoration-none"
              >
                Productos
              </a>
            </div>
          </li>

          <!-- PRODUCTOS (EMPLEADO) -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('listarProductosEmpleado')"
          >
            <i class="bi bi-box2-heart fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-productos-empleado"
                class="text-dark text-decoration-none"
              >
                Productos (Empleado)
              </a>
            </div>
          </li>

          <!-- VENTAS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer(['registrarVenta', 'registrarVenta-Empleado'])"
          >
            <i class="bi bi-cart-check fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-ventas"
                class="text-dark text-decoration-none"
              >
                Ventas
              </a>
            </div>
          </li>

          <!-- DETALLE VENTAS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="
              puedeVer([
                'registrarDetalleVenta',
                'registrar-DetalleVenta-Empleado'
              ])
            "
          >
            <i class="bi bi-journal-text fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-detalle-ventas"
                class="text-dark text-decoration-none"
              >
                Detalle Ventas
              </a>
            </div>
          </li>

          <!-- VENDER -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="
              puedeVer([
                'registrarVenta-DetalleVenta-Administrador',
                'registrarVenta-DetalleVenta-Empleado'
              ])
            "
          >
            <i class="bi bi-bag-plus fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-productos-empleado"
                class="text-dark text-decoration-none"
              >
                Vender Productos
              </a>
            </div>
          </li>

          <!-- TARJETAS -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('PedidoTarjetas')"
          >
            <i class="bi bi-credit-card-2-front fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/targetas"
                class="text-dark text-decoration-none"
              >
                Tarjetas Entel, Tigo
              </a>
            </div>
          </li>

          <!-- RECARGA PRODUCTO -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('RegistrarJuegos')"
          >
            <i class="bi bi-controller fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-RecargaProducto"
                class="text-dark text-decoration-none"
              >
                Registrar Juegos
              </a>
            </div>
          </li>

          <!-- DETALLE VENTA RECARGA -->
          <li
            class="d-flex align-items-center p-2 rounded"
            *ngIf="puedeVer('VenderJugos')"
          >
            <i class="bi bi-joystick fs-2 text-dark"></i
            ><i class="bi bi-cash-coin fs-2 text-dark"></i>
            <div class="flex-grow-1 text-start ms-2">
              <a
                routerLink="/panel-control/listar-DetalleVentaRecarga"
                class="text-dark text-decoration-none"
              >
                Venta de Juegos
              </a>
            </div>
          </li>
        </ul>
      </ul>
    </div>
  </aside>

  <!-- Overlay -->
  <div
    class="overlay"
    *ngIf="windowWidth < 768"
    [class.overlay-visible]="isSidebarOpen"
    (click)="toggleSidebar()"
  ></div>

  <!-- Contenido Principal -->
  <main
    class="main-content"
    [class.content-shifted]="isSidebarOpen && windowWidth >= 768"
  >
    <router-outlet></router-outlet>
  </main>
</section>
